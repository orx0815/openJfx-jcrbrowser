# Deploy OpenJfx Jcr Browser
These maven projects  generates a variety of deployment artifacts:

- Old-school executable jars with dependencies included. Needs jvm installed.
- Platform dependent installers with custom modularized jvm. On Windows .msi, on Mac .dmg or .pks, on Linux .deb or .rpm files.
- Ahead-of-Time compiled native binaries generated by [GraalVm](https://www.graalvm.org/) using the [Gluon Client plugin](https://github.com/gluonhq/client-maven-plugin). No jvm needed anymore. 
- JNLP generation and jar-signing for web-based installations from static webserver with [OpenWebStart](https://openwebstart.com/). Unlike java-8 [Oracle WebStart](https://en.wikipedia.org/wiki/Java_Web_Start), it has a jvm manager.
- Web server to run it in the browser after all. This is a product from [jPro](https://www.jpro.one) and NOT free for commercial use. And not open-source. But quite impressive, you can try it out without any hassle by just adding their maven plugin.
 
 All from the same code base.
 
#### Build a distributable uber/fat.jar and run it with `java -jar`

The uber.jar is build by maven-shade-plugin:

    mvn -f maven-shade/pom.xml package
    java -jar ./maven-shade/target/openjfx-jcr-browser.deploy.shade.desktop-1.0.0-SNAPSHOT-[PLATFORM]-uber.jar

The next jar by [spring-boot-maven-plugin](https://docs.spring.io/spring-boot/docs/current/reference/html/executable-jar.html). Different jar layout inside, default logging configuration in colour.

    mvn -f spring-boot-maven/pom.xml package
    java -jar ./spring-boot-maven/target/openjfx-jcr-browser.deploy.spring-cli.desktop-1.0.0-SNAPSHOT-[PLATFORM]-fat.jar

 
This is the 'old' style and still requires java to be installed on the target system. This is normally too much for normal users so the modern way is "bring your own jvm".
Jars are still platform dependent, javaFx has native dependencies for each platform.


####  Platform dependent installers including custom small jvm

Requires java14+ as the [jpackage](https://openjdk.java.net/jeps/392) tool is only available there.
In java16 it moved from incubator state to a production-ready feature.

Since the application is not modularized due to non-modular 3rd party dependencies, some extra steps are performed here. This is inspired by Dirk Lemmerman's [JPackageScriptFX](https://github.com/dlemmermann/JPackageScriptFX). You can only build an installer for the platform the maven build is running on.

On Windows you need the [Wix Toolset](https://wixtoolset.org) installed on the machine for MSI installers. I had to enable .NET Framework 3.5 (Control Panel - Windows Features - check '.NET Framework 3.5'). Maven will find it, no need to open the program.
For setup.exe style installers you'll need INNO setup. When running GitHub Actions both ist preinstalled on the VMs for you get when running 'windows-latest' 

    mvn -f ./jpackagefx/pom.xml package
    
In ./jpackagefx/target/installer you'll find the .msi/.deb/.rpm/.dkp/.pkg for your platform.


#### GraalVm

Deserves it's own [ReadMe](./graalvm/ReadMe.md)


#### Run in the browser with jPro (commercial license !)

    mvn -f ./jpro/pom.xml jpro:release

Extract the zip, go into the /bin folder and run start-script with java11 on the path.
Visit http://localhost:8080


#### Web Launcher with update mechanism

For https://openwebstart.com/

     mvn -f ./webstart/pom.xml package
     
Signs all jar's with the example openwebstart.jks and generates a jnlp-file (with a very old webstart-maven-plugin) as a starting point. Remove the line:

    codebase="http://motorbrot.org/404/jnlp"

from ./target/jnlp/OpenJfxJcrBrowser.jnlp. When you have openwebstart installed on your machine you can doubleclick it and it will start. Add a proper codebase + jks and you can put it on a static webserver or shared network folder.

Other notable alternatives:
https://github.com/threerings/getdown
https://github.com/edvin/fxlauncher
